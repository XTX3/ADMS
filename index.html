<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù†Ø¸Ø§Ù… Ø¬Ø±Ø¯ Ø§Ù„Ù‡ÙˆØ§ØªÙ</title>
  <style>
    body{font-family:Arial, sans-serif;background:#f7f7f7;margin:0}
    header{background:#007bff;color:#fff;padding:1rem;text-align:center}
    nav{display:flex;justify-content:center;gap:1rem;background:#e0e0e0;padding:.5rem}
    nav button{padding:.5rem 1rem;border:0;border-radius:5px;background:#007bff;color:#fff;cursor:pointer}
    section{display:none;padding:1rem} section.active{display:block}
    input,button{margin:.3rem 0;padding:.5rem;width:100%;box-sizing:border-box}
    button[disabled]{opacity:.5;cursor:not-allowed}
    table{width:100%;border-collapse:collapse;margin-top:1rem;background:#fff}
    th,td{border:1px solid #999;padding:.5rem;text-align:center}
    .stats-box{background:#fff;border:1px solid #ccc;border-radius:8px;padding:1rem;margin:1rem 0}
    .message{color:#d00;margin:.2rem 0;font-size:.9rem}
    .edit-btn{cursor:pointer;color:blue}
  </style>
</head>
<body>
  <header><h1>Ù†Ø¸Ø§Ù… Ø¬Ø±Ø¯ Ø§Ù„Ù‡ÙˆØ§ØªÙ</h1></header>
  <nav>
    <button onclick="showSection('add')">ğŸ“¦ Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…Ø®Ø²Ù†</button>
    <button onclick="showSection('sell')">ğŸ’° Ø¨ÙŠØ¹ Ø¬Ù‡Ø§Ø²</button>
    <button onclick="showSection('stats')">ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
  </nav>

  <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¶Ø§ÙØ© -->
  <section id="add" class="active">
    <h2>Ø¥Ø¶Ø§ÙØ© Ù‡Ø§ØªÙ Ù„Ù„Ù…Ø®Ø²Ù†</h2>
    <input id="addName"     placeholder="Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© (Ù…Ø«Ù„Ø§Ù‹: Samsung)">
    <input id="addType"     placeholder="Ø§Ù„Ù†ÙˆØ¹ (Ù…Ø«Ù„Ø§Ù‹: A14)">
    <input id="addRam"      placeholder="Ø§Ù„Ø±Ø§Ù… (Ù…Ø«Ù„Ø§Ù‹: 4GB)">
    <input id="addStorage"  placeholder="Ø§Ù„Ø°Ø§ÙƒØ±Ø© (Ù…Ø«Ù„Ø§Ù‹: 128GB)">
    <input id="addQty" type="number" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
    <button id="addBtn" onclick="addPhone()">â• Ø¥Ø¶Ø§ÙØ©</button>

    <h3>ğŸ“‹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†</h3>
    <table id="stockTable">
      <thead><tr><th>Ø§Ù„Ø´Ø±ÙƒØ©</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø±Ø§Ù…</th><th>Ø§Ù„Ø°Ø§ÙƒØ±Ø©</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>ØªØ¹Ø¯ÙŠÙ„</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙƒÙ…Ø§ Ù‡ÙŠ ØªÙ…Ø§Ù…Ù‹Ø§ -->

  <script>
    let storage = JSON.parse(localStorage.getItem("phones")) || [];
    let sales   = JSON.parse(localStorage.getItem("sales"))  || [];

    let editIndex = -1; // Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¬Ù‡Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯

    function addPhone() {
      const name = addName.value.trim(), type = addType.value.trim(),
            ram = addRam.value.trim(), storageVal = addStorage.value.trim(),
            qty = parseInt(addQty.value.trim());

      if (!name || !type || !ram || !storageVal || isNaN(qty) || qty <= 0) {
        alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„"); return;
      }

      if (editIndex >= 0) {
        // ØªØ¹Ø¯ÙŠÙ„
        storage[editIndex] = { name, type, ram, storage: storageVal, qty };
        editIndex = -1;
        addBtn.textContent = "â• Ø¥Ø¶Ø§ÙØ©";
      } else {
        // Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯ Ø£Ùˆ Ø¯Ù…Ø¬ Ù…Ø¹ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
        const item = storage.find(p => p.name === name && p.type === type && p.ram === ram && p.storage === storageVal);
        if (item) item.qty += qty;
        else storage.push({ name, type, ram, storage: storageVal, qty });
      }

      saveData(); renderStockTable();
      addName.value = addType.value = addRam.value = addStorage.value = addQty.value = "";
    }

    function editPhone(index) {
      const p = storage[index];
      addName.value = p.name;
      addType.value = p.type;
      addRam.value = p.ram;
      addStorage.value = p.storage;
      addQty.value = p.qty;
      addBtn.textContent = "ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„";
      editIndex = index;
      showSection('add');
    }

    function renderStockTable() {
      const tbody = stockTable.querySelector("tbody");
      tbody.innerHTML = "";
      storage.forEach((p, i) => {
        tbody.insertAdjacentHTML("beforeend",
          `<tr><td>${p.name}</td><td>${p.type}</td><td>${p.ram}</td><td>${p.storage}</td><td>${p.qty}</td><td><span class="edit-btn" onclick="editPhone(${i})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</span></td></tr>`
        );
      });
    }

    function showSection(id) {
      document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
      if (id === "add") renderStockTable();
    }

    function saveData() {
      localStorage.setItem("phones", JSON.stringify(storage));
      localStorage.setItem("sales", JSON.stringify(sales));
    }

    renderStockTable();
  </script>
</body>
</html>
